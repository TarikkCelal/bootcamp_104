<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Diabalysis - Profil Sayfası</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/profil.css') }}"> <!-- Profil CSS dosyası -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body>

  <!-- Navbar (Üst menü) -->
  <nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container">
      <!-- Logo Yer Tutucu -->
      <a class="navbar-brand d-flex align-items-center" href="/"> <!-- Ana sayfaya yönlendirilecek bağlantı -->
        <div class="logo me-2"></div> <!-- Buraya logo yerleştirilecek -->
        <span class="fw-bold text-dark">diabalysis</span>
      </a>
      <div class="collapse navbar-collapse justify-content-end">
        <ul class="navbar-nav me-3">
          <li class="nav-item">
            <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">Ana Sayfa</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path.startswith('/hakkimizda') %}active{% endif %}" href="/hakkimizda">Hakkında</a>
          </li>
          
          {% if 'email' in session %}
            <!-- Giriş yapıldıysa sadece profil ikonunu göster -->
             <li class="nav-item d-flex align-items-center">
               <a class="nav-link" href="/profil">
                <img src="{{ url_for('static', filename=session.get('profil_foto', 'img/user.png')) }}" alt="Profil" class="navbar-avatar">
              </a>
             </li>
          {% else %}
            <!-- Giriş yapılmadıysa Giriş Yap butonu göster -->
            <li class="nav-item">
              <a class="btn btn-orange" href="/bize-katil">Giriş Yap</a>
            </li>
          {% endif %}    
        </ul>    
      </div>
    </div>
  </nav>

<div class="container profile-container">
  <div class="row g-4 align-items-stretch">
    <!-- Profil Fotoğrafı -->
    <div class="col-md-6 d-flex flex-column">
      <div class="card h-100 p-0">
        <form method="POST" action="{{ url_for('profil_fotograf_yukle') }}" enctype="multipart/form-data" class="h-100">
          <label for="profilFotoInput" style="cursor: pointer; height: 100%; display: block;">
            <img src="{{ url_for('static', filename=profil_foto) }}" alt="Profil Fotoğrafı" class="profile-image-clickable">
          </label>
          <input type="file" id="profilFotoInput" name="profil_foto" accept="image/*" onchange="this.form.submit()" style="display: none;">  
        </form>
      </div>

      <!-- Kaldır butonu dışarıda -->
      <form method="POST" action="{{ url_for('profil_fotograf_sil') }}">
        <button type="submit" class="btn btn-orange mt-2 align-self-start">Profil Fotoğrafını Kaldır</button>
      </form>
    </div>


    <!-- Kişisel Bilgiler -->
    <div class="col-md-6 d-flex flex-column">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="card-title">Kişisel Bilgilerim</h5>
          <form method="POST" action="{{ url_for('profil_guncelle') }}" id="profilForm">
            <!-- input alanları -->
            <div class="mb-3">
              <label for="adSoyad" class="form-label">Ad Soyad</label>
              <input type="text" class="form-control" id="adSoyad" name="adSoyad" value="{{ isim }} {{ soyisim }}">
            </div>
            <div class="mb-3">
              <label for="telefon" class="form-label">Telefon Numarası</label>
              <input type="text" class="form-control" id="telefon" name="telefon" value="{{ telefon }}">
            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Mail</label>
              <input type="email" class="form-control" id="email" name="email" value="{{ email }}">
            </div>
            <div class="mb-3">
              <label for="yas" class="form-label">Yaş</label>
              <input type="number" class="form-control" id="yas" name="yas" value="{{ yas }}">
            </div>
            <div class="mb-3">
              <label for="boy" class="form-label">Boy</label>
              <input type="number" class="form-control" id="boy" name="boy" value="{{ boy }}">
            </div>
            <div class="mb-3">
              <label for="kilo" class="form-label">Kilo</label>
              <input type="number" class="form-control" id="kilo" name="kilo" value="{{ kilo }}">
            </div>
          </form>
        </div>
      </div>
      <!-- Güncelle butonu kart dışında ve alt hizalı -->
      <button type="submit" form="profilForm" class="btn btn-orange mt-2 align-self-start">Güncelle</button>
    </div>
  </div>


      <div class="row g-4 mt-4">
        <!-- Geçmiş Analiz Sonuçları -->
        <div class="col-md-6">
          <div class="card h-100">
            <div class="card-body d-flex flex-column justify-content-between">
              <div>
                <h5 class="card-title">Geçmiş Analiz Sonuçlarım</h5>
                <div class="result-box">
                  {% if analiz_tarihleri %}
                    {% for tarih in analiz_tarihleri %}
                      <div class="result-item">
                        <span class="result-label">{{ tarih }}</span>
                      </div>
                    {% endfor %}
                  {% else %}
                    <div class="result-item">
                      <span class="result-label">Henüz analiz yapılmamış.</span>
                    </div>
                  {% endif %}
                </div>
              </div>
              
              <!-- Önceki Buton Baş Kısımda -->
              <div class="navigation">
                <span class="btn-text"><< Önceki</span>
                <span class="btn-text">Sonraki >></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Geçmiş Randevularım -->
        <div class="col-md-6">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">Geçmiş Randevularım</h5>
              <div class="result-box">
                {% if randevular %}
                  {% for r in randevular %}
                    <div class="result-item mb-3">
                      <!-- Tarih -->
                      <span class="result-label">{{ r[0]|replace("-", ".") }}</span><br>

                      <!-- Saat -->
                      <span class="result-label">
                        {% if r[1] %}
                          {{ r[1] }}
                        {% else %}
                          Saat belirtilmemiş
                        {% endif %}
                      </span><br><br>

                      <!-- Doktor -->
                      <span class="result-label"><strong>{{ r[2] }}</strong></span>
                    </div>
                  {% endfor %}
                {% else %}
                  <p class="text-muted">Hiç randevunuz bulunmamaktadır.</p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
</div>

<!-- Bootstrap JS ve Popper.js -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>


  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div id="flash-message" class="alert alert-info text-center mt-3">
        {{ messages[0] }}
      </div>
    {% endif %}
 {% endwith %}


  <!-- Bülten Aboneliği -->
  <section class="py-5 text-center">
    <div class="container">
      <h3 class="mb-3 fw-bold">Haber bültenimize katıl</h3>
      <form action="{{ url_for('abone') }}" method="POST" class="d-flex justify-content-center gap-2"> <!--method="POST" → Flask'a veri göndereceğiz.action="/abone-ol" → Flask'ta tanımlayacağımız route adresi.name="email" → Bu input'tan gelen değeri Python'da request.form['email'] ile alacağız.-->
          <input type="email" name="email" class="form-control w-50" placeholder="E-mail" required>
          <button class="btn btn-orange">Bize abone ol</button>
      </form>
    </div>
  </section>

  <!-- Alt Bilgi (Footer) -->
  <footer class="bg-gradient-green text-white py-4">
    <div class="container d-flex flex-column flex-lg-row justify-content-between">
      <div>
        <!-- Alt Logo Yer Tutucu -->
           <!-- Logo ve yazı yan yana -->
        <div class="d-flex align-items-center mb-2">
            <div class="footer-logo me-2"></div> <!-- Logo -->
            <span class="footer-brand-text">diabalysis</span> <!-- Yanındaki yazı -->
        </div>
        <p>Sağlıklı Beden, Mutlu Yaşam Erken Tespit Sağlıklı Gelecek</p>
      </div>

      <div>
        <h6>İletişim</h6>
        <p><i class="fas fa-phone-alt me-2"></i>+90 546 525 8272</p>
        <p><i class="fas fa-envelope me-2"></i>diabalysis@gmail.com</p>
        <p><i class="fas fa-map-marker-alt me-2"></i>Atatürk Caddesi No:123, Daire:5 Beşiktaş, İstanbul</p>
      </div>
      <div>
        <h6>Harita</h6>
        <div class="map"></div> <!-- Harita görseli buraya -->
      </div>
    </div>
    
    <!-- İletişim ile sosyal medya ikonları arasındaki çizgi -->
    <hr class="footer-divider">


    <!-- Sosyal medya ikonları PNG (ortalanmış) -->
    <div class="text-center mt-4">
        <img src="{{ url_for('static', filename='img/sosyalmedyaicons.png') }}" alt="Sosyal Medya İkonları" class="social-icons-img">
    </div>
    <!-- Telif hakkı -->
    <div class="text-center mt-3 small">© 2023 diabalysis - Tüm Hakları Saklıdır</div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>



</body>
</html>